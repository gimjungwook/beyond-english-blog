<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë¹„ìš˜ë“œì‰ê¸€ë¦¬ì‹œ ë¸”ë¡œê·¸ ìƒì„±ê¸°</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #1a0a0a;
      color: #e5e5e5;
      min-height: 100vh;
      padding: 20px;
    }
    
    .container { max-width: 1100px; margin: 0 auto; }
    
    .header {
      text-align: center;
      margin-bottom: 40px;
      padding-top: 20px;
    }
    .header h1 { 
      font-size: 1.8rem; 
      font-weight: 600;
      color: #fff;
      margin-bottom: 8px;
    }
    .header p { 
      color: #666;
      font-size: 0.95rem;
    }
    
    .card {
      background: #1f0d0d;
      border: 1px solid #3d1e1e;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 16px;
    }
    
    .card h2 {
      font-size: 0.85rem;
      font-weight: 500;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 16px;
    }
    
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 24px;
      border: 1px solid #3d1e1e;
      border-radius: 8px;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.15s;
      font-weight: 500;
      background: #1f0d0d;
      color: #fff;
    }
    
    .btn:hover {
      background: #3d1e1e;
      border-color: #5a2e2e;
    }
    
    .btn-primary {
      background: #dc2626;
      color: #fff;
      border-color: #dc2626;
    }
    .btn-primary:hover {
      background: #b91c1c;
      border-color: #b91c1c;
    }
    .btn-primary:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }
    
    .btn-sm {
      padding: 8px 14px;
      font-size: 0.85rem;
    }
    
    .topic-box {
      padding: 32px;
      text-align: center;
      margin-bottom: 24px;
    }
    .topic-box .label { 
      font-size: 0.8rem; 
      color: #666; 
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .topic-box .topic { 
      font-size: 1.3rem; 
      font-weight: 500;
      color: #fff; 
      line-height: 1.5;
    }
    
    .btn-group {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .stats {
      display: flex;
      gap: 32px;
      justify-content: center;
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid #3d1e1e;
    }
    .stat { text-align: center; }
    .stat .num {
      font-size: 1.5rem;
      font-weight: 600;
      color: #fff;
    }
    .stat .label {
      font-size: 0.75rem;
      color: #666;
      margin-top: 4px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .grid {
      display: grid;
      grid-template-columns: 1fr 320px;
      gap: 16px;
    }
    @media (max-width: 900px) {
      .grid { grid-template-columns: 1fr; }
    }
    
    .title-option {
      padding: 14px 16px;
      background: #1f0d0d;
      border: 1px solid #3d1e1e;
      border-radius: 8px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.15s;
    }
    .title-option:hover {
      background: #3d1e1e;
      border-color: #5a2e2e;
    }
    
    .body-content {
      line-height: 1.8;
      color: #ccc;
      max-height: 500px;
      overflow-y: auto;
      padding-right: 10px;
      font-size: 0.95rem;
    }
    .body-content::-webkit-scrollbar { width: 6px; }
    .body-content::-webkit-scrollbar-track { background: #1f0d0d; }
    .body-content::-webkit-scrollbar-thumb { background: #3d1e1e; border-radius: 3px; }
    .body-content h1 {
      font-size: 1.25rem;
      color: #fff;
      margin: 28px 0 14px 0;
      font-weight: 600;
    }
    .body-content h2 {
      font-size: 1.15rem;
      color: #fff;
      margin: 24px 0 12px 0;
      font-weight: 600;
    }
    .body-content h3 {
      font-size: 1.1rem;
      color: #fff;
      margin: 20px 0 10px 0;
      font-weight: 600;
    }
    .body-content p {
      margin: 12px 0;
    }
    .body-content strong {
      color: #fff;
      font-weight: 600;
    }
    .body-content ul, .body-content ol {
      margin: 12px 0;
      padding-left: 24px;
    }
    .body-content li {
      margin: 6px 0;
    }
    
    .hashtags {
      padding: 16px;
      background: #1f0d0d;
      border: 1px solid #3d1e1e;
      border-radius: 8px;
      color: #888;
      cursor: pointer;
      transition: all 0.15s;
    }
    .hashtags:hover { 
      background: #3d1e1e;
      color: #aaa;
    }
    
    .image-card {
      margin-bottom: 12px;
      border-radius: 8px;
      overflow: hidden;
      border: 1px solid #3d1e1e;
      background: #1f0d0d;
    }
    .image-card img {
      width: 100%;
      height: 140px;
      object-fit: cover;
      display: block;
    }
    .image-info {
      padding: 12px;
    }
    .image-info .keyword { 
      font-size: 0.8rem; 
      color: #666;
      display: block;
      margin-bottom: 8px;
    }
    .image-tip {
      font-size: 0.75rem;
      color: #555;
      background: #120606;
      padding: 8px 10px;
      border-radius: 4px;
      margin-top: 8px;
    }
    .credit {
      padding: 8px 12px;
      font-size: 0.7rem;
      color: #555;
      border-top: 1px solid #3d1e1e;
    }
    .credit a { color: #888; }
    
    .loading {
      text-align: center;
      padding: 80px 20px;
    }
    .spinner {
      width: 40px;
      height: 40px;
      border: 2px solid #3d1e1e;
      border-top-color: #dc2626;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 24px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .loading p { 
      font-size: 0.95rem; 
      color: #666;
    }
    
    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: #dc2626;
      color: #fff;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 500;
      opacity: 0;
      transition: all 0.3s;
      z-index: 1000;
    }
    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
    
    .hidden { display: none !important; }
    
    .auth-screen {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #1a0a0a;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    .auth-box {
      text-align: center;
      padding: 40px;
    }
    .auth-box h1 {
      font-size: 1.5rem;
      color: #fff;
      margin-bottom: 8px;
    }
    .auth-box > p {
      color: #666;
      margin-bottom: 32px;
    }
    .auth-box input {
      width: 200px;
      padding: 14px 20px;
      border: 1px solid #3d1e1e;
      border-radius: 8px;
      background: #1f0d0d;
      color: #fff;
      font-size: 1.2rem;
      text-align: center;
      letter-spacing: 8px;
      margin-bottom: 16px;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    .auth-box input:focus {
      outline: none;
      border-color: #dc2626;
    }
    .auth-box input::placeholder {
      letter-spacing: normal;
      font-size: 0.95rem;
    }
    .auth-error {
      color: #ef4444;
      font-size: 0.85rem;
      margin-top: 12px;
      min-height: 20px;
    }
    
    .back-row {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 16px;
    }
    .back-row .topic-label {
      color: #666;
      font-size: 0.9rem;
    }
    
    .copy-tip {
      background: #1f0d0d;
      border: 1px solid #3d1e1e;
      border-radius: 8px;
      padding: 16px;
      margin-top: 16px;
    }
    .copy-tip h3 {
      font-size: 0.8rem;
      color: #666;
      font-weight: 500;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .copy-tip p {
      font-size: 0.85rem;
      color: #888;
      line-height: 1.6;
    }
    .copy-tip code {
      background: #120606;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.8rem;
      color: #aaa;
    }
    
    .settings-form {
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid #3d1e1e;
    }
    .settings-form h3 {
      font-size: 0.8rem;
      color: #666;
      font-weight: 500;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .settings-form input {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #3d1e1e;
      border-radius: 6px;
      background: #120606;
      color: #fff;
      font-size: 0.85rem;
      margin-bottom: 8px;
    }
    .settings-form input:focus {
      outline: none;
      border-color: #dc2626;
    }
    .settings-form input::placeholder {
      color: #555;
    }
    .settings-form .btn {
      margin-top: 8px;
    }
    .api-status {
      font-size: 0.75rem;
      color: #666;
      margin-top: 8px;
    }
    .api-status.ok { color: #22c55e; }
    .api-status.missing { color: #ef4444; }
  </style>
</head>
<body>
  <div id="auth-screen" class="auth-screen">
    <div class="auth-box">
      <h1>ë¹„ìš˜ë“œì‰ê¸€ë¦¬ì‰¬</h1>
      <p>ë¸”ë¡œê·¸ ìƒì„±ê¸°</p>
      <input type="password" id="password-input" placeholder="ë¹„ë°€ë²ˆí˜¸" maxlength="4" autocomplete="off">
      <button class="btn btn-primary" onclick="checkPassword()">í™•ì¸</button>
      <p id="auth-error" class="auth-error"></p>
    </div>
  </div>

  <div class="container" id="main-container" style="display: none;">
    <div class="header">
      <h1>ë¸”ë¡œê·¸ ìƒì„±ê¸°</h1>
      <p>ë¹„ìš˜ë“œì‰ê¸€ë¦¬ì‰¬ Â· ê²°ê³¼ê°€ ë‹¤ë¥¸ ì˜ì–´</p>
    </div>

    <!-- ë©”ì¸ í™”ë©´ -->
    <div id="main-view">
      <div class="card">
        <div class="topic-box">
          <div class="label">Next Topic</div>
          <div class="topic" id="next-topic">ë¡œë”© ì¤‘...</div>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" id="generate-btn" onclick="generateBlog()">
            ìƒì„±í•˜ê¸°
          </button>
        </div>
        <div class="btn-group" style="margin-top: 12px;">
          <button class="btn btn-sm" onclick="skipTopic()">ê±´ë„ˆë›°ê¸°</button>
          <button class="btn btn-sm" onclick="resetAll()">ì´ˆê¸°í™”</button>
        </div>
        <div class="btn-group" style="margin-top: 12px;">
          <a href="https://blog.naver.com/GoBlogWrite.naver" target="_blank" class="btn btn-sm">ê¸€ì“°ê¸°</a>
          <a href="https://blog.naver.com/jjbeyond" target="_blank" class="btn btn-sm">ë¸”ë¡œê·¸</a>
          <button class="btn btn-sm" onclick="toggleSettings()">ì„¤ì •</button>
        </div>
        
        <div id="settings-panel" class="settings-form hidden">
          <h3>API í‚¤ ì„¤ì •</h3>
          <input type="password" id="gemini-key" placeholder="Gemini API Key">
          <input type="password" id="unsplash-key" placeholder="Unsplash Access Key">
          <button class="btn btn-sm" onclick="saveApiKeys()">ì €ì¥</button>
          <div id="api-status" class="api-status"></div>
        </div>
        
        <div class="stats">
          <div class="stat">
            <div class="num" id="pending-count">0</div>
            <div class="label">Remaining</div>
          </div>
          <div class="stat">
            <div class="num" id="completed-count">0</div>
            <div class="label">Completed</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loading-view" class="card hidden">
      <div class="loading">
        <div class="spinner"></div>
        <p id="loading-text">ê¸€ì„ ì‘ì„±í•˜ëŠ” ì¤‘...</p>
      </div>
    </div>

    <!-- ê²°ê³¼ í™”ë©´ -->
    <div id="result-view" class="hidden">
      <div class="back-row">
        <button class="btn btn-sm" onclick="backToMain()">â† ëŒì•„ê°€ê¸°</button>
        <span class="topic-label" id="result-topic"></span>
      </div>
      
      <div class="grid">
        <div class="main-content">
          <div class="card">
            <h2>ì œëª© ì˜µì…˜</h2>
            <div id="titles-container"></div>
          </div>
          
          <div class="card">
            <h2>ë³¸ë¬¸</h2>
            <div class="body-content" id="body-content"></div>
            <div class="btn-group" style="margin-top: 16px; justify-content: flex-start;">
              <button class="btn btn-sm" onclick="copyBody()">ë³¸ë¬¸ ë³µì‚¬</button>
              <button class="btn btn-primary btn-sm" onclick="copyAll()">ì „ì²´ ë³µì‚¬</button>
            </div>
          </div>
          
          <div class="card">
            <h2>í•´ì‹œíƒœê·¸</h2>
            <div class="hashtags" id="hashtags" onclick="copyHashtags()"></div>
          </div>
        </div>
        
        <div class="sidebar">
          <div class="card">
            <h2>ì´ë¯¸ì§€</h2>
            <div id="images-container"></div>
            
            <div class="copy-tip">
              <h3>ì´ë¯¸ì§€ ë³µì‚¬ ë°©ë²•</h3>
              <p>
                ì´ë¯¸ì§€ ìœ„ì—ì„œ <code>ìš°í´ë¦­</code> â†’ <code>ì´ë¯¸ì§€ ë³µì‚¬</code> í›„<br>
                ë„¤ì´ë²„ ë¸”ë¡œê·¸ ì—ë””í„°ì— <code>Ctrl+V</code> (Mac: <code>Cmd+V</code>)
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    let GEMINI_API_KEY = localStorage.getItem('gemini_api_key') || '';
    let UNSPLASH_ACCESS_KEY = localStorage.getItem('unsplash_api_key') || '';

    const ALL_TOPICS = [
      "ìš°ë¦¬ ì•„ì´ ì´ˆë“± ì˜ì–´ ì‹œì‘, ì–¸ì œë¶€í„°ê°€ ì¢‹ì„ê¹Œìš”?",
      "ì´ˆë“± ì €í•™ë…„ ì˜ì–´, í¥ë¯¸ ìƒì§€ ì•Šê³  ì¦ê²ê²Œ í•˜ëŠ” ë²•",
      "ì—„ë§ˆí‘œ ì˜ì–´, ì„±ê³µí•˜ëŠ” ë¹„ë²• 5ê°€ì§€ (ì˜ì•Œëª» ì—„ë§ˆë„ ê°€ëŠ¥!)",
      "ì´ˆë“± ì˜ì–´ í•™ì›, ì–¸ì œë¶€í„° ë³´ë‚´ì•¼ í• ê¹Œ? ìš°ë¦¬ ì•„ì´ì—ê²Œ ë§ëŠ” í•™ì› ì„ íƒ ê°€ì´ë“œ",
      "ì´ˆë“± ì˜ì–´ ë‹¨ì–´, íš¨ê³¼ì ìœ¼ë¡œ ì™¸ìš°ëŠ” ê¿€íŒ (ë†€ì´ì²˜ëŸ¼!)",
      "ì´ˆë“± ì˜ì–´ ë“£ê¸° ì‹¤ë ¥ í–¥ìƒ, ë§¤ì¼ 10ë¶„ íˆ¬ìë¡œ ê°€ëŠ¥í•´ìš”!",
      "ì´ˆë“± íŒŒë‹‰ìŠ¤, ì§‘ì—ì„œ ì‰½ê³  ì¬ë¯¸ìˆê²Œ ê°€ë¥´ì¹˜ëŠ” ë°©ë²•",
      "ìš°ë¦¬ ì•„ì´ ì˜ì–´ ë§í•˜ê¸° ìì‹ ê°, ì–´ë–»ê²Œ í‚¤ì›Œì¤„ê¹Œìš”?",
      "ì´ˆë“± ì˜ì–´ ê·¸ë¦¼ì±…, íš¨ê³¼ì ìœ¼ë¡œ í™œìš©í•˜ëŠ” íŒ (ë‹¨ê³„ë³„ ì¶”ì²œ)",
      "ì´ˆë“±í•™ìƒ ì˜ì–´ ì•± ì¶”ì²œ, êµìœ¡ì ì´ë©´ì„œ ì¬ë¯¸ìˆëŠ” BEST 5",
      "ë¬´ë£Œ ì˜ì–´ í•™ìŠµ ì‚¬ì´íŠ¸, ì´ê²ƒë§Œ ì•Œì•„ë„ ì¶©ë¶„í•´ìš”!",
      "ìœ íŠœë¸Œ ì˜ì–´ ì±„ë„, ìš°ë¦¬ ì•„ì´ ì˜ì–´ êµìœ¡ì— ë„ì›€ ë˜ëŠ” ê³³ì€?",
      "ì´ˆë“± ì˜ì–´ ë¬¸ë²•, ì•„ì´ ëˆˆë†’ì´ì— ë§ì¶° ì‰½ê²Œ ì„¤ëª…í•˜ê¸°",
      "ìƒí™œ ì† ì˜ì–´ í‘œí˜„, ì•„ì´ì™€ í•¨ê»˜ ì¨ë³´ì„¸ìš”! (ì´ˆê°„ë‹¨ ë£¨í‹´)",
      "ì—¬ë¦„ë°©í•™, ì´ˆë“± ì˜ì–´ ì‹¤ë ¥ ì—…ê·¸ë ˆì´ë“œ í”„ë¡œì íŠ¸ (ì•Œì°¬ ê³„íš ì„¸ìš°ê¸°)",
      "ê²¨ìš¸ë°©í•™, ì´ˆë“± ì˜ì–´ ëª°ì… í•™ìŠµ, ì´ë ‡ê²Œ ì‹œì‘í•˜ì„¸ìš”!",
      "ì´ˆë“± ì˜ì–´ ìˆ™ì œ, ìŠ¤íŠ¸ë ˆìŠ¤ ì—†ì´ ì¦ê²ê²Œ í•˜ëŠ” ë²•",
      "ì´ˆë“± ì˜ì–´ ë¬¸ì œì§‘, ìš°ë¦¬ ì•„ì´ì—ê²Œ ë§ëŠ” ì„ íƒ ê°€ì´ë“œ",
      "ì›ì–´ë¯¼ í™”ìƒ ì˜ì–´, íš¨ê³¼ ì œëŒ€ë¡œ ë³´ëŠ” íŒ (ì„ ìƒë‹˜ ê³ ë¥´ëŠ” ê¸°ì¤€)",
      "ì´ˆë“± ì˜ì–´ ì¼ê¸° ì“°ê¸°, ê¾¸ì¤€íˆ í•˜ëŠ” ë¹„ë²•ê³¼ ì£¼ì œ ì¶”ì²œ",
      "ì˜ì–´ ë™ìš”, ì•„ì´ ë°œìŒ êµì •ì— íš¨ê³¼ì ì¸ ì´ìœ ì™€ ì¶”ì²œê³¡",
      "í•´ì™¸ì—¬í–‰ ëŒ€ë¹„! ì´ˆë“± ì•„ì´ì™€ í•¨ê»˜í•˜ëŠ” ê¸°ì´ˆ ì˜ì–´ íšŒí™”",
      "ì´ˆë“± ì˜ì–´ ìº í”„, ìš°ë¦¬ ì•„ì´ì—ê²Œ ë§ëŠ” ì„ íƒê³¼ ì¤€ë¹„ë¬¼",
      "ì´ˆë“± ì˜ì–´ ìŠ¬ëŸ¼í”„, ê·¹ë³µí•˜ëŠ” ë¶€ëª¨ì˜ ì§€í˜œ (ë‹¤ë…ì´ëŠ” ë²•)",
      "AI ì˜ì–´ í•™ìŠµ, ìš°ë¦¬ ì•„ì´ì—ê²Œ ì¢‹ì„ê¹Œ? ì¥ë‹¨ì  ë¶„ì„",
      "ìŠ¤í¬ë¦° íƒ€ì„, ì˜ì–´ êµìœ¡ì— ì–´ë–»ê²Œ í™œìš©í•´ì•¼ í• ê¹Œìš”?",
      "ì´ˆë“± ì €í•™ë…„ ì˜ì–´ ë¦¬ë”©, ë…ì„œ ìŠµê´€ ë§Œë“œëŠ” ë²•",
      "ì´ˆë“± ê³ í•™ë…„ ì˜ì–´, ë¬¸í•´ë ¥ê³¼ ë…í•´ë ¥ ë™ì‹œì— ì¡ëŠ” ë¹„ë²•",
      "ì´ˆë“± ì˜ì–´ ìˆ˜í–‰í‰ê°€, ë¯¸ë¦¬ ëŒ€ë¹„í•˜ëŠ” ë°©ë²•ê³¼ íŒ",
      "ì˜ì–´ ê±°ë¶€ê° ìˆëŠ” ì•„ì´, ë‹¤ì‹œ í¥ë¯¸ ë¶™ì´ëŠ” ë²•",
      "ì´ˆë“± ì˜ì–´ í™ˆìŠ¤ì¿¨ë§, ì„±ê³µì„ ìœ„í•œ ë¶€ëª¨ì˜ ì—­í• ",
      "ë¡¤í”Œë ˆì´ë¡œ ë°°ìš°ëŠ” ìƒí™œ ì˜ì–´, ì§‘ì—ì„œ ë”°ë¼í•˜ê¸°!",
      "ì´ˆë“± ì˜ì–´ ë°œìŒ, ì›ì–´ë¯¼ì²˜ëŸ¼ êµì •í•˜ëŠ” ì—°ìŠµë²•",
      "ì¹­ì°¬ì€ ê³ ë˜ë„ ì¶¤ì¶”ê²Œ í•œë‹¤! ì˜ì–´ í•™ìŠµ ì¹­ì°¬ë²•",
      "ì´ˆë“± ì˜ì–´ í•™ì› vs ê³¼ì™¸ vs ì—„ë§ˆí‘œ, ìš°ë¦¬ ì•„ì´ì—ê²Œ ë§ëŠ” êµìœ¡ë²• ì°¾ê¸°",
      "ì´ˆë“± ì˜ì–´ ë“£ê¸° í˜ë ¤ë“£ê¸° vs ì§‘ì¤‘ë“£ê¸°, íš¨ê³¼ì ì¸ ë°©ë²•ì€?",
      "ì´ˆë“± ì˜ì–´ ì“°ê¸°, ì–´ë–»ê²Œ ì‹œì‘í•´ì•¼ í• ê¹Œìš”? (ì‰¬ìš´ ë‹¨ê³„ë¶€í„°)",
      "ì´ˆë“± ì˜ì–´ ë°œí‘œ, ìì‹ ê° ë¿œë¿œ! ë‘ë ¤ì›€ ê·¹ë³µ íŒ",
      "ì˜ì–´ ì›ì„œ ì½ê¸°, ì´ˆë“± ì•„ì´ ìˆ˜ì¤€ì— ë§ëŠ” ì±… ê³ ë¥´ëŠ” ìš”ë ¹",
      "ì´ˆë“± ì¡¸ì—… ì „, ê¼­ ì•Œì•„ì•¼ í•  í•„ìˆ˜ ì˜ì–´ í‘œí˜„ 50ê°€ì§€",
      "ì˜ì–´ í•™ìŠµ ë™ê¸° ë¶€ì—¬, ì•„ì´ì˜ ë‚´ì  ë™ê¸°ë¥¼ ê¹¨ìš°ëŠ” ë²•",
      "ë†€ë©´ì„œ ë°°ìš°ëŠ” ì˜ì–´! ì§‘ì—ì„œ í•  ìˆ˜ ìˆëŠ” ì˜ì–´ ê²Œì„ 10ê°€ì§€",
      "ì´ˆë“± ì˜ì–´ ë…í•´ë ¥, ì¬ë¯¸ìˆê²Œ í‚¤ìš°ëŠ” ë°©ë²•",
      "ì˜ì–´ë¥¼ ë°°ìš°ë©´ ì¢‹ì€ ì , ìš°ë¦¬ ì•„ì´ì—ê²Œ ì„¤ëª…í•´ ì£¼ëŠ” ë²•",
      "ì´ˆë“± ì˜ì–´ êµìœ¡, ë¶€ëª¨ê°€ ë¨¼ì € ì•„ëŠ” í° ê·¸ë¦¼ê³¼ ë¡œë“œë§µ",
      "ì´ˆë“± ì˜ì–´ ë‹¨ì–´ì¥, ìš°ë¦¬ ì•„ì´ë§Œì˜ íŠ¹ë³„í•œ ë‹¨ì–´ì¥ ë§Œë“¤ê¸°",
      "ì´ˆë“± ì˜ì–´ ë°œìŒ êµì •, íš¨ê³¼ì ì¸ ì„€ë„ì‰ ì—°ìŠµë²•",
      "ì˜ì–´ ìŠ¤í”¼í‚¹ íŒŒíŠ¸ë„ˆ, ì§‘ì—ì„œ ì°¾ì•„ì£¼ëŠ” ë°©ë²• (ì—†ë‹¤ë©´?)",
      "ì´ˆë“± ì €í•™ë…„ ì˜ì–´ ì•ŒíŒŒë²³, ì‰½ê³  ë¹ ë¥´ê²Œ ìµíˆëŠ” ë…¸í•˜ìš°",
      "ì´ˆë“± ì˜ì–´ í•™ìŠµ ëª©í‘œ ì„¤ì •, ì•„ì´ì™€ í•¨ê»˜ ì„¸ìš°ëŠ” ë²•"
    ];

    let completedTopics = [];
    let currentTopicIndex = 0;

    function init() {
      const saved = localStorage.getItem('blog_completed_topics');
      completedTopics = saved ? JSON.parse(saved) : [];
      updateDisplay();
    }

    function updateDisplay() {
      const pending = ALL_TOPICS.filter(t => !completedTopics.includes(t));
      const topicEl = document.getElementById('next-topic');
      const btn = document.getElementById('generate-btn');
      
      document.getElementById('pending-count').textContent = pending.length;
      document.getElementById('completed-count').textContent = completedTopics.length;
      
      if (pending.length === 0) {
        topicEl.textContent = 'ëª¨ë“  ì£¼ì œ ì™„ë£Œ';
        btn.disabled = true;
      } else {
        if (currentTopicIndex >= pending.length) currentTopicIndex = 0;
        topicEl.textContent = pending[currentTopicIndex];
        btn.disabled = false;
      }
    }

    function skipTopic() {
      const pending = ALL_TOPICS.filter(t => !completedTopics.includes(t));
      if (pending.length > 1) {
        currentTopicIndex = (currentTopicIndex + 1) % pending.length;
        updateDisplay();
      }
    }

    function resetAll() {
      if (confirm('ì™„ë£Œ ê¸°ë¡ì„ ëª¨ë‘ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        completedTopics = [];
        localStorage.removeItem('blog_completed_topics');
        currentTopicIndex = 0;
        updateDisplay();
        showToast('ì´ˆê¸°í™” ì™„ë£Œ');
      }
    }

    function markCompleted(topic) {
      if (!completedTopics.includes(topic)) {
        completedTopics.push(topic);
        localStorage.setItem('blog_completed_topics', JSON.stringify(completedTopics));
      }
    }

    async function generateBlog() {
      GEMINI_API_KEY = localStorage.getItem('gemini_api_key') || '';
      UNSPLASH_ACCESS_KEY = localStorage.getItem('unsplash_api_key') || '';
      
      if (!GEMINI_API_KEY) {
        showToast('Gemini API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”');
        toggleSettings();
        return;
      }
      
      const pending = ALL_TOPICS.filter(t => !completedTopics.includes(t));
      if (pending.length === 0) return;
      
      const topic = pending[currentTopicIndex];
      showView('loading');
      
      try {
        document.getElementById('loading-text').textContent = 'ê¸€ì„ ì‘ì„±í•˜ëŠ” ì¤‘...';
        const content = await callGemini(topic);
        const parsed = parseGeminiResponse(content);
        
        document.getElementById('loading-text').textContent = 'ì´ë¯¸ì§€ë¥¼ ê²€ìƒ‰í•˜ëŠ” ì¤‘...';
        const images = await searchImages(parsed.imageKeywords);
        
        markCompleted(topic);
        renderResult(topic, parsed, images);
        showView('result');
        
      } catch (error) {
        console.error(error);
        showToast('ì˜¤ë¥˜: ' + error.message);
        showView('main');
      }
    }

    async function callGemini(topic) {
      const prompt = `ë„¤ì´ë²„ ë¸”ë¡œê·¸ ì „ë¬¸ ì‘ê°€. ì´ˆë“± ìë…€ ë‘” 3040 í•™ë¶€ëª¨ ëŒ€ìƒ ì˜ì–´ êµìœ¡ ì½˜í…ì¸ .

[ì£¼ì œ] ${topic}

[ì œëª© ê·œì¹™]
â€¢ 25~35ì, í‚¤ì›Œë“œ ì•ë°°ì¹˜
â€¢ ìˆ«ì/How-to/ì§ˆë¬¸í˜•/ë¶€ì •í˜• ì¤‘ 2ê°œ ì¡°í•©
â€¢ ê°ì • ë‹¨ì–´ í¬í•¨: ê¿€íŒ, í•„ìˆ˜, ì™„ë²½, í•µì‹¬, ë¹„ë²•

[ë³¸ë¬¸ ê·œì¹™]
â€¢ ë¶„ëŸ‰: 1,000~1,200ì (ê°„ê²°í•˜ê²Œ)
â€¢ ë§íˆ¬: ì¹œê·¼í•œ "~ìš”" ì²´
â€¢ êµ¬ì¡°: ë„ì…(2ë¬¸ì¥) â†’ ë³¸ë¡ (3ê°œ ì†Œì œëª©) â†’ ê²°ë¡ (2ë¬¸ì¥, ë¹„ìš˜ë“œì‰ê¸€ë¦¬ì‹œ ìì—°ìŠ¤ëŸ½ê²Œ ì–¸ê¸‰)
â€¢ ê° ì†Œì œëª©: ì‚¬ì‹¤/í•´ì„/ê²½í—˜/ê²©ë ¤ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ ë…¹ì—¬ì„œ ì‘ì„± (ë¼ë²¨ ë¶™ì´ì§€ ë§ ê²ƒ)

[í•´ì‹œíƒœê·¸] ì •í™•íˆ 5ê°œ, ë„ì–´ì“°ê¸° ì—†ì´

[ì¶œë ¥ í˜•ì‹] - ì½”ë“œë¸”ë¡ ì—†ì´ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë¡œ
## ì œëª© ì˜µì…˜
1. ì œëª©1
2. ì œëª©2
3. ì œëª©3

## ë³¸ë¬¸
<p>ë„ì… ë‚´ìš©</p>
<h1>ğŸ¯ ì†Œì œëª© 1</h1>
<p>ë³¸ë¬¸... <strong>ê°•ì¡°</strong>...</p>
<ul><li>í•­ëª©1</li><li>í•­ëª©2</li></ul>
<h1>ğŸ“š ì†Œì œëª© 2</h1>
<p>ë³¸ë¬¸...</p>
<h1>âœ¨ ì†Œì œëª© 3</h1>
<p>ë³¸ë¬¸...</p>
<p>ê²°ë¡ ...</p>

## í•´ì‹œíƒœê·¸
#í‚¤ì›Œë“œ1 #í‚¤ì›Œë“œ2 #í‚¤ì›Œë“œ3 #í‚¤ì›Œë“œ4 #ë¹„ìš˜ë“œì‰ê¸€ë¦¬ì‰¬

## ì´ë¯¸ì§€ ê²€ìƒ‰ í‚¤ì›Œë“œ
1. ì˜ì–´í‚¤ì›Œë“œ1
2. ì˜ì–´í‚¤ì›Œë“œ2
3. ì˜ì–´í‚¤ì›Œë“œ3`;

      const response = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
        }
      );

      if (!response.ok) {
        const error = await response.json();
        throw new Error(error.error?.message || 'API í˜¸ì¶œ ì‹¤íŒ¨');
      }

      const data = await response.json();
      return data.candidates[0].content.parts[0].text;
    }

    function parseGeminiResponse(text) {
      const result = { titles: [], body: '', hashtags: '', imageKeywords: [] };

      const titleMatch = text.match(/## ì œëª© ì˜µì…˜\s*([\s\S]*?)(?=## ë³¸ë¬¸)/);
      if (titleMatch) {
        result.titles = titleMatch[1].trim().split('\n')
          .map(line => line.replace(/^\d+\.\s*/, '').trim())
          .filter(line => line.length > 0);
      }

      const bodyMatch = text.match(/## ë³¸ë¬¸\s*([\s\S]*?)(?=## í•´ì‹œíƒœê·¸)/);
      if (bodyMatch) {
        // ```html ì½”ë“œë¸”ë¡ ì œê±°
        result.body = bodyMatch[1].trim()
          .replace(/^```html\s*/i, '')
          .replace(/```\s*$/, '')
          .trim();
      }

      const hashtagMatch = text.match(/## í•´ì‹œíƒœê·¸\s*([\s\S]*?)(?=## ì´ë¯¸ì§€|$)/);
      if (hashtagMatch) result.hashtags = hashtagMatch[1].trim();

      const imageMatch = text.match(/## ì´ë¯¸ì§€ ê²€ìƒ‰ í‚¤ì›Œë“œ\s*([\s\S]*?)$/);
      if (imageMatch) {
        result.imageKeywords = imageMatch[1].trim().split('\n')
          .map(line => line.replace(/^\d+\.\s*/, '').trim())
          .filter(line => line.length > 0);
      }

      return result;
    }

    async function searchImages(keywords) {
      const images = [];
      
      for (const keyword of keywords.slice(0, 3)) {
        try {
          const url = `https://api.unsplash.com/search/photos?query=${encodeURIComponent(keyword)}&per_page=1&orientation=landscape`;
          const response = await fetch(url, {
            headers: { 'Authorization': `Client-ID ${UNSPLASH_ACCESS_KEY}` }
          });
          
          if (!response.ok) continue;
          
          const data = await response.json();
          if (data.results?.length > 0) {
            const photo = data.results[0];
            images.push({
              keyword,
              url: photo.urls.regular,
              photographer: photo.user.name,
              photographerUrl: photo.user.links.html
            });
          }
        } catch (e) {
          console.error(e);
        }
      }
      
      return images;
    }

    function renderResult(topic, parsed, images) {
      document.getElementById('result-topic').textContent = topic;
      
      document.getElementById('titles-container').innerHTML = parsed.titles
        .map((title, i) => `<div class="title-option" onclick="copyText('${title.replace(/'/g, "\\'")}', 'ì œëª©')">${i + 1}. ${title}</div>`)
        .join('');
      
      document.getElementById('body-content').innerHTML = parsed.body;
      document.getElementById('hashtags').textContent = parsed.hashtags;
      
      if (images.length > 0) {
        document.getElementById('images-container').innerHTML = images.map(img => `
          <div class="image-card">
            <img src="${img.url}" alt="${img.keyword}">
            <div class="image-info">
              <span class="keyword">${img.keyword}</span>
            </div>
            <div class="credit">by <a href="${img.photographerUrl}?utm_source=blog_tool" target="_blank">${img.photographer}</a></div>
          </div>
        `).join('');
      } else {
        document.getElementById('images-container').innerHTML = '<p style="color:#666;text-align:center;padding:20px;">ì´ë¯¸ì§€ ì—†ìŒ</p>';
      }
    }

    function copyText(text, label) {
      navigator.clipboard.writeText(text).then(() => showToast(label + ' ë³µì‚¬ë¨'));
    }

    async function copyHtml(html, label) {
      try {
        const blob = new Blob([html], { type: 'text/html' });
        const clipboardItem = new ClipboardItem({ 'text/html': blob });
        await navigator.clipboard.write([clipboardItem]);
        showToast(label + ' ë³µì‚¬ë¨ (ì„œì‹ ìœ ì§€)');
      } catch (err) {
        // fallback to plain text
        navigator.clipboard.writeText(html.replace(/<[^>]*>/g, '')).then(() => {
          showToast(label + ' ë³µì‚¬ë¨ (í…ìŠ¤íŠ¸ë§Œ)');
        });
      }
    }

    function copyBody() {
      const bodyHtml = document.getElementById('body-content').innerHTML;
      copyHtml(bodyHtml, 'ë³¸ë¬¸');
    }

    function copyHashtags() {
      copyText(document.getElementById('hashtags').textContent, 'í•´ì‹œíƒœê·¸');
    }

    async function copyAll() {
      const title = document.querySelector('.title-option')?.textContent.replace(/^\d+\.\s*/, '') || '';
      const bodyHtml = document.getElementById('body-content').innerHTML;
      const hashtags = document.getElementById('hashtags').textContent;
      const fullHtml = `<h2>${title}</h2>${bodyHtml}<p>${hashtags}</p>`;
      await copyHtml(fullHtml, 'ì „ì²´');
    }

    function showView(view) {
      document.getElementById('main-view').classList.toggle('hidden', view !== 'main');
      document.getElementById('loading-view').classList.toggle('hidden', view !== 'loading');
      document.getElementById('result-view').classList.toggle('hidden', view !== 'result');
    }

    function backToMain() {
      showView('main');
      updateDisplay();
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2000);
    }

    const AUTH_KEY = 'beyond_auth';
    const CORRECT_PASSWORD = '3872';

    function checkAuth() {
      if (localStorage.getItem(AUTH_KEY) === 'true') {
        showApp();
      }
    }

    function checkPassword() {
      const input = document.getElementById('password-input');
      const error = document.getElementById('auth-error');
      
      if (input.value === CORRECT_PASSWORD) {
        localStorage.setItem(AUTH_KEY, 'true');
        showApp();
      } else {
        error.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤';
        input.value = '';
        input.focus();
      }
    }

    function showApp() {
      document.getElementById('auth-screen').style.display = 'none';
      document.getElementById('main-container').style.display = 'block';
      updateApiStatus();
    }

    function toggleSettings() {
      const panel = document.getElementById('settings-panel');
      panel.classList.toggle('hidden');
      if (!panel.classList.contains('hidden')) {
        document.getElementById('gemini-key').value = localStorage.getItem('gemini_api_key') || '';
        document.getElementById('unsplash-key').value = localStorage.getItem('unsplash_api_key') || '';
      }
    }

    function saveApiKeys() {
      const geminiKey = document.getElementById('gemini-key').value.trim();
      const unsplashKey = document.getElementById('unsplash-key').value.trim();
      
      if (geminiKey) localStorage.setItem('gemini_api_key', geminiKey);
      if (unsplashKey) localStorage.setItem('unsplash_api_key', unsplashKey);
      
      window.GEMINI_API_KEY = geminiKey;
      window.UNSPLASH_ACCESS_KEY = unsplashKey;
      
      updateApiStatus();
      showToast('API í‚¤ ì €ì¥ë¨');
      document.getElementById('settings-panel').classList.add('hidden');
    }

    function updateApiStatus() {
      const gemini = localStorage.getItem('gemini_api_key');
      const unsplash = localStorage.getItem('unsplash_api_key');
      const status = document.getElementById('api-status');
      
      if (gemini && unsplash) {
        status.textContent = 'âœ“ API í‚¤ ì„¤ì • ì™„ë£Œ';
        status.className = 'api-status ok';
      } else {
        const missing = [];
        if (!gemini) missing.push('Gemini');
        if (!unsplash) missing.push('Unsplash');
        status.textContent = 'âœ— ' + missing.join(', ') + ' í‚¤ í•„ìš”';
        status.className = 'api-status missing';
      }
    }

    function getApiKey(name) {
      return localStorage.getItem(name) || '';
    }

    document.addEventListener('DOMContentLoaded', () => {
      checkAuth();
      init();
      
      document.getElementById('password-input').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') checkPassword();
      });
    });
  </script>
</body>
</html>
